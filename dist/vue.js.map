{"version":3,"file":"vue.js","sources":["../src/observe/arr.js","../src/observe/index.js","../src/initState.js","../src/init.js","../src/index.js"],"sourcesContent":["/*\nimport { observer } from './index';\n * @Author: wzy\n * @Date: 2024-02-03 18:49:19\n * @LastEditTime: 2024-02-05 12:17:20\n * @LastEditors: wzy\n * @Description: 对数组类型进行响应式处理\n * @FilePath: /myVue/src/observe/arr.js\n */\n// 重写数组\n// 获取数组原来的方法\nlet oldArrayProtoMethods = Array.prototype;\n// 继承\nexport let ArrayMehods = Object.create(oldArrayProtoMethods);\n// 劫持\nlet methods = [\"push\", \"pop\", \"shift\", \"unshift\", \"sort\", \"splice\", \"reverse\"];\nmethods.forEach((item) => {\n\tArrayMehods[item] = function (...args) {\n\t\tconsole.log(\"劫持数组\");\n\t\t// 对追加数据进行响应式处理\n\t\tlet inserted;\n\t\tswitch (item) {\n\t\t\tcase \"push\":\n\t\t\tcase \"unshift\":\n\t\t\t\tinserted = args;\n\t\t\t\tbreak;\n\t\t\tcase \"splice\":\n\t\t\t\tconsole.log(\"args\", args);\n\t\t\t\tinserted = args.splice(2);\n\t\t\t\tbreak;\n\t\t}\n\t\t// 如果有追加的实例则将追加的数据进行响应式处理\n\t\tlet ob = this.__ob__;\n\t\tif (inserted) {\n\t\t\tob.observerArray(inserted);\n\t\t}\n\n\t\tlet result = oldArrayProtoMethods[item].apply(this, args);\n\t\treturn result;\n\t};\n});\n","/*\nimport { observer } from './index';\n * @Author: wzy\n * @Date: 2024-02-03 18:01:08\n * @LastEditTime: 2024-02-05 12:17:32\n * @LastEditors: wzy\n * @Description:\n * @FilePath: /myVue/src/observe/index.js\n */\nimport { ArrayMehods } from \"./arr\";\nexport function observer(data) {\n\tif (typeof data !== \"object\" || data == null) {\n\t\treturn data;\n\t}\n\t// 对象类型处理\n\treturn new Observer(data);\n}\n\nclass Observer {\n\tconstructor(data) {\n\t\t// 给data定义一个属性 将observer内置的方法绑定到上面，方便后续逻辑调用\n\t\tObject.defineProperty(data, \"__ob__\", {\n\t\t\tenumerable: false,\n\t\t\tvalue: this,\n\t\t});\n\t\tif (Array.isArray(data)) {\n\t\t\tconsole.log(\"数组\");\n\t\t\tdata.__proto__ = ArrayMehods;\n\t\t\t// 如果是数组对象\n\t\t\tthis.observerArray(data);\n\t\t} else {\n\t\t\t// 对象\n\t\t\tthis.walk(data); // 遍历\n\t\t}\n\t}\n\twalk(data) {\n\t\tlet keys = Object.keys(data);\n\t\tfor (let i = 0; i < keys.length; i++) {\n\t\t\t// 对每个属性进行劫持\n\t\t\tlet key = keys[i];\n\t\t\tlet value = data[key];\n\t\t\tdefineReactive(data, key, value);\n\t\t}\n\t}\n\tobserverArray(data) {\n\t\t// 处理数组内是对象的情况\n\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\tobserver(data[i]);\n\t\t}\n\t}\n}\nfunction defineReactive(data, key, value) {\n\t// 对像类型进行递归处理,深度劫持\n\tobserver(value);\n\tObject.defineProperty(data, key, {\n\t\tget() {\n\t\t\treturn value;\n\t\t},\n\t\tset(newValue) {\n\t\t\tif (newValue == value) return;\n\t\t\tobserver(newValue); // 如果设置的是对象，则进行数据响应\n\t\t\tvalue = newValue;\n\t\t},\n\t});\n}\n\n// 总结：\n// 1.对象类型处理\n// Object.defineProperty 有缺点 只能对 对象中的一个属性进行劫持\n// 深层嵌套对象需要遍历 递归处理\n// 用户在对劫持数据进行set操作时 如果新的数据是对象类型也需要进行响应式处理\n\n// 2.数组\n// 对数组的劫持采用的是，重写可以改变数组本省的7个方法（push,pop,shift,unshift,splice,sort,reverse）\n","/*\n * @Author: wzy\n * @Date: 2024-02-03 17:28:41\n * @LastEditTime: 2024-02-05 11:56:21\n * @LastEditors: wzy\n * @Description:\n * @FilePath: /myVue/src/initState.js\n */\n\nimport { observer } from \"./observe/index.js\";\n\nexport function initState(vm) {\n\tlet opts = vm.$options;\n\t//判断\n\tif (opts.props) {\n\t}\n\tif (opts.methods) {\n\t}\n\tif (opts.data) {\n\t\tinitData(vm);\n\t}\n\n\tif (opts.computed) {\n\t}\n\tif (opts.watch) {\n\t}\n}\nfunction initData(vm) {\n\tlet data = vm.$options.data;\n\t// 判断data类型是对象还是函数 获取data配置\n\tdata = vm._data = typeof data == \"function\" ? data.call(vm) : data; //注意这里this指向\n\t// 将data上所有的属性代理到vm实例上\n\tfor (let key in data) {\n\t\tproxy(vm, \"_data\", key);\n\t}\n\t// 对data进行劫持\n\tobserver(data);\n}\nfunction proxy(vm, source, key) {\n\tObject.defineProperty(vm, key, {\n\t\tget() {\n\t\t\treturn vm[source][key];\n\t\t},\n\t\tset(newValue) {\n\t\t\tvm[source][key] = newValue;\n\t\t},\n\t});\n}\n","/*\n * @Author: wzy\n * @Date: 2024-02-03 17:16:22\n * @LastEditTime: 2024-02-03 17:38:57\n * @LastEditors: wzy\n * @Description:\n * @FilePath: /myVue/src/init.js\n */\nimport { initState } from \"./initState\";\nexport function initMixin(Vue) {\n\tVue.prototype._init = function (options) {\n\t\tlet vm = this;\n\t\tthis.$options = options;\n\t\t// 初始化状态\n\t\tinitState(vm);\n\t};\n}\n","/*\n * @Author: your name\n * @Date: 2024-02-03 10:45:00\n * @LastEditTime: 2024-02-03 17:39:01\n * @LastEditors: wzy\n * @Description:\n * @FilePath: /myVue/src/index.js\n * 可以输入预定的版权声明、个性签名、空行等\n */\n\nimport { initMixin } from \"./init\";\n\nfunction Vue(options) {\n\tthis._init(options);\n}\ninitMixin(Vue);\nexport default Vue;\n"],"names":["oldArrayProtoMethods","Array","prototype","ArrayMehods","Object","create","methods","forEach","item","console","log","inserted","_len","arguments","length","args","_key","splice","ob","__ob__","observerArray","result","apply","observer","data","_typeof","Observer","_classCallCheck","defineProperty","enumerable","value","isArray","__proto__","walk","_createClass","key","keys","i","defineReactive","get","set","newValue","initState","vm","opts","$options","props","initData","computed","watch","_data","call","proxy","source","initMixin","Vue","_init","options"],"mappings":"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"}